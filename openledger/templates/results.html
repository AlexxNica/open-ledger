{% import "includes/pagination.html" as pagination %}
{% import "includes/image-result.html" as image_result %}

{% extends "base.html" %}

{% block body %}

<div class="row column" style="margin-top: 1rem">
  <h3>Open Ledger</h3>
  <p>
    Images displayed here are sourced from a variety of organizations and individuals
    supporting open content.
  </p>
</div>

{% with %}
  {% set endpoint = url_for('fulltext') %}
  {% include "includes/search-form.html" %}
{% endwith %}

<div class="row column results">

  {% if 'search' in search_data and search_data.search and results.pages == 0 %}
  <h3>No results were found for '{{ search_data.search }}'</h3>
  {% elif results.pages > 0 %}

  {% if results.pages > 1 %}
  <h5>Page {{ results.page }} of {{ results.pages }} page{{ results.pages|pluralize }}</h5>
  {% endif %}

   {{ pagination.paginate_openledger(results.page, results.pages, search_data_for_pagination) }}

    <div class="row">
      {% for result in results.items %}
        {% with image = {} %}
          {% do image.update({'creator': result.creator,
                              'license': result.license,
                              'provider_url': result.foreign_landing_url,
                              'creator_url': result.creator_url,
                              'title': result.title,
                              'url': result.url,
                              'thumbnail': result.url,}) %}
        {% set detail_url = url_for('detail', identifier=result.identifier) %}
        {{ image_result.show(detail_url, "fulltext", image) }}

        {% endwith %}
      {% endfor %}
    </div>
    {{ pagination.paginate_openledger(results.page, results.pages, search_data_for_pagination) }}

    {% endif %}
  </div>


{% endblock %}
