{% import "includes/pagination.html" as pagination %}
<!doctype html>
<title>Open Ledger prototype</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.2.3/foundation-flex.min.css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">

<form method="GET" action="">
  <div class="row" style="margin-top: 2em">
    <div class="column medium-6">
      {{ form.search.label }}
      {{ form.search }}
      <p>Searches to try: <a href="/?search=paris">paris</a> | <a href="/?search=sunset">sunset</a> | <a href="?search=open">open</a> | <a href="?search=sheep&licenses=CC0">sheep, CC0-only</a></p>

    </div>
    <div class="column medium-6">
      <fieldset>
        <legend>
          I want something I can...
        </legend>
      {{ form.licenses }}
      </fieldset>
    </div>
  </div>

</form>

{% if results %}
<div class="row column results">
  <h2>Results for <i>{{ search }}</i> </h2>
  <!-- Flickr -->
  {% if results.flickr %}
    <h3>{{ results.flickr.photos.total }} photo{{ results.flickr.photos.total|pluralize }} from Flickr</h3>

    {{ pagination.paginate(results.flickr.photos.page, results.flickr.photos.pages, search, 'flickr')}}

    <div class="row">
      {% for result in results.flickr.photos.photo %}
      <div class="shrink columns">
        <!-- https://www.flickr.com/photos/{user-id}/{photo-id} - individual photo -->
        <figure>
          <div class="figure-wrapper">
            <a href="https://www.flickr.com/photos/{{ result.owner }}/{{ result.id }}">
              <img src="{{ result.url_m }}" class="thumbnail" width="200" />
            </a>
          </div>
          <figcaption>
            {{ result.ownername }}
            <img src="{{ url_for('static', filename='images/' + license_map.flickr[result.license].lower() + '.png')}}" alt="{{ license_map.flickr[result.license] }}" title="{{ license_map.flickr[result.license] }}"/ />
          </figcaption>
        </figure>
      </div>
      {% endfor %}
    </div>
  {% endif %}

  <!-- 500px -->
  {% if results.fpx %}
    <h3>{{ results.fpx.total_items }} photo{{ results.fpx.total_items|pluralize }} from 500px</h3>

    <div class="row">
      {% for result in results.fpx.photos %}
      <div class="shrink columns">
        <figure>
          <div class="figure-wrapper">
            <a href="https://500px.com/{{ result.url }}">
              <img src="{{ result.images.0.https_url }}" class="thumbnail" width="200" />
            </a>
          </div>
          <figcaption>
            {{ result.user.username }}
            <img src="{{ url_for('static', filename='images/' + license_map.fpx[result.license_type].lower() + '.png')}}" alt="{{ license_map.fpx[result.license_type] }}" title="{{ license_map.fpx[result.license_type] }}"/ />
          </figcaption>
        </figure>
      </div>
      {% endfor %}
    </div>
  {% endif %}

  <!-- rijksmuseum -->
  {% if results.rijks %}
  <h3>{{ results.rijks.count }} photo{{ results.rijks.count|pluralize }} from Rijksmuseum</h3>
    <div class="row">
      {% for result in results.rijks.artObjects %}
      <div class="shrink columns">
        <figure>
          <div class="figure-wrapper">
            <a href="{{ result.links.web }}">
              <img src="{{ result.webImage.url }}" class="thumbnail" width="200">
            </a>
          </div>
          <figcaption>
            {{ result.title }}
            <img src="{{ url_for('static', filename='images/cc0.png')}}" alt="CC0" title="CC0"/ />
          </figcaption>
        </figure>
      </div>
      {% endfor %}
  </div>
  {% endif %}

  <!-- Wikimedia -->
  {% if results.wikimedia %}
  <h3>{{ results.wikimedia.results.bindings|length }} photo{{ results.wikimedia.results.bindings|length|pluralize }} from Wikimedia Commons</h3>
  <div class="row">
    {% for result in results.wikimedia.results.bindings %}
    <div class="shrink columns">
      <figure>
        <div class="figure-wrapper">
          <a href="{{ result.item.value }}">
            <img src="{{ result.pic.value }}" class="thumbnail" width="200">
          </a>
        </div>
        <figcaption>
          {{ result.itemLabel.value }}
          <img src="{{ url_for('static', filename='images/cc0.png')}}" alt="CC0" title="CC0"/ />
        </figcaption>
      </figure>
    </div>
    {% endfor %}
  </div>
  {% endif %}
</div>

{% endif %}
